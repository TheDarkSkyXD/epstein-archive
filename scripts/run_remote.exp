#!/usr/bin/expect

set timeout 300
set host [lindex $argv 0]
set user [lindex $argv 1]
set password [lindex $argv 2]
set script_path [lindex $argv 3]

spawn ssh -o StrictHostKeyChecking=no $user@$host "bash -s" < $script_path
expect {
  "password:" {
    send "$password\r"
    exp_continue
  }
  eof
}
